<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>广告测试页面</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 20px;
        background-color: #f5f5f5;
      }
      .test-container {
        max-width: 800px;
        margin: 0 auto;
        background: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }
      .ad-test {
        margin: 20px 0;
        padding: 20px;
        border: 2px dashed #ccc;
        border-radius: 8px;
        text-align: center;
        min-height: 100px;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .ad-test.banner {
        min-height: 90px;
      }
      .ad-test.sidebar {
        width: 160px;
        min-height: 600px;
        float: left;
        margin-right: 20px;
      }
      .status {
        padding: 10px;
        margin: 10px 0;
        border-radius: 4px;
        font-weight: bold;
      }
      .status.success {
        background-color: #d4edda;
        color: #155724;
        border: 1px solid #c3e6cb;
      }
      .status.error {
        background-color: #f8d7da;
        color: #721c24;
        border: 1px solid #f5c6cb;
      }
      .status.info {
        background-color: #d1ecf1;
        color: #0c5460;
        border: 1px solid #bee5eb;
      }
      button {
        background-color: #007bff;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 4px;
        cursor: pointer;
        margin: 5px;
      }
      button:hover {
        background-color: #0056b3;
      }
      .clearfix::after {
        content: '';
        clear: both;
        display: table;
      }
    </style>
  </head>
  <body>
    <div class="test-container">
      <h1>Google AdSense 广告测试页面</h1>

      <div class="status info">
        <strong>测试说明：</strong> 此页面用于测试您的Google AdSense广告是否正常工作。
      </div>

      <div class="status info"><strong>广告客户端ID：</strong> ca-pub-4638984121333143</div>

      <button onclick="loadAds()">手动加载广告</button>
      <button onclick="checkAdStatus()">检查广告状态</button>
      <button onclick="clearAds()">清除广告</button>

      <hr />

      <!-- 横幅广告测试 -->
      <h2>横幅广告测试 (广告位: 3707198686)</h2>
      <div class="ad-test banner">
        <ins
          class="adsbygoogle"
          style="display: block"
          data-ad-client="ca-pub-4638984121333143"
          data-ad-slot="3707198686"
          data-ad-format="auto"
          data-full-width-responsive="true"
        ></ins>
      </div>

      <div class="clearfix">
        <!-- 侧边栏广告测试 -->
        <h2>侧边栏广告测试 (广告位: 6904540807)</h2>
        <div class="ad-test sidebar">
          <ins
            class="adsbygoogle"
            style="display: block"
            data-ad-client="ca-pub-4638984121333143"
            data-ad-slot="6904540807"
            data-ad-format="auto"
            data-full-width-responsive="true"
          ></ins>
        </div>

        <!-- 移动端广告测试 -->
        <h2>移动端广告测试 (广告位: 3423077907)</h2>
        <div class="ad-test">
          <ins
            class="adsbygoogle"
            style="display: block"
            data-ad-client="ca-pub-4638984121333143"
            data-ad-slot="3423077907"
            data-ad-format="auto"
            data-full-width-responsive="true"
          ></ins>
        </div>
      </div>

      <div id="status-log"></div>
    </div>

    <!-- Google AdSense 脚本 -->
    <script
      async
      src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4638984121333143"
      crossorigin="anonymous"
    ></script>

    <script>
      function log(message, type = 'info') {
        const logDiv = document.getElementById('status-log')
        const timestamp = new Date().toLocaleTimeString()
        const statusDiv = document.createElement('div')
        statusDiv.className = `status ${type}`
        statusDiv.innerHTML = `<strong>[${timestamp}]</strong> ${message}`
        logDiv.appendChild(statusDiv)
        console.log(`[${timestamp}] ${message}`)
      }

      function loadAds() {
        log('开始加载广告...', 'info')

        if (window.adsbygoogle && typeof window.adsbygoogle.push === 'function') {
          try {
            const adElements = document.querySelectorAll('.adsbygoogle:not([data-ad-status])')
            log(`找到 ${adElements.length} 个未处理的广告元素`, 'info')

            adElements.forEach((el, index) => {
              try {
                el.setAttribute('data-ad-status', 'loading')
                const adSlot = el.getAttribute('data-ad-slot')
                log(`正在加载广告 ${index + 1} (广告位: ${adSlot})`, 'info')
                ;(window.adsbygoogle = window.adsbygoogle || []).push({})
              } catch (error) {
                log(`广告 ${index + 1} 加载失败: ${error.message}`, 'error')
                el.removeAttribute('data-ad-status')
              }
            })
          } catch (error) {
            log(`广告加载过程中发生错误: ${error.message}`, 'error')
          }
        } else {
          log('Google AdSense 脚本未加载或不可用', 'error')
        }
      }

      function checkAdStatus() {
        log('检查广告状态...', 'info')

        const adElements = document.querySelectorAll('.adsbygoogle')
        log(`总共有 ${adElements.length} 个广告元素`, 'info')

        adElements.forEach((el, index) => {
          const adSlot = el.getAttribute('data-ad-slot')
          const adStatus = el.getAttribute('data-ad-status')
          const hasContent = el.children.length > 0

          log(
            `广告 ${index + 1} (广告位: ${adSlot}): 状态=${adStatus}, 有内容=${hasContent}`,
            hasContent ? 'success' : 'error',
          )
        })
      }

      function clearAds() {
        log('清除所有广告...', 'info')

        const adElements = document.querySelectorAll('.adsbygoogle')
        adElements.forEach((el) => {
          el.removeAttribute('data-ad-status')
          el.innerHTML = ''
        })

        log('广告已清除', 'success')
      }

      // 页面加载完成后自动加载广告
      window.addEventListener('load', function () {
        log('页面加载完成，等待广告脚本加载...', 'info')

        // 等待广告脚本加载
        const waitForAdScript = () => {
          if (window.adsbygoogle) {
            log('Google AdSense 脚本已加载', 'success')
            setTimeout(loadAds, 1000) // 延迟1秒加载广告
          } else {
            setTimeout(waitForAdScript, 100)
          }
        }

        waitForAdScript()
      })

      // 监听广告加载事件
      window.addEventListener('message', function (event) {
        if (event.data && event.data.type === 'adsbygoogle') {
          log(`收到广告消息: ${event.data.type}`, 'info')
        }
      })
    </script>
  </body>
</html>
