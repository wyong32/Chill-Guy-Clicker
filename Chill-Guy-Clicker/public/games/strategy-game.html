<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Simple Strategy Game</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #222;
      color: white;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }
    .game-container {
      width: 800px;
      max-width: 95vw;
      background-color: #333;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
    }
    .game-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 10px;
      border-bottom: 2px solid #008080;
    }
    .resources {
      display: flex;
      gap: 20px;
    }
    .resource {
      display: flex;
      align-items: center;
      gap: 5px;
    }
    .resource-icon {
      width: 20px;
      height: 20px;
      background-color: #008080;
      border-radius: 50%;
    }
    .game-grid {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 10px;
      margin-bottom: 20px;
    }
    .grid-cell {
      aspect-ratio: 1;
      background-color: #444;
      border-radius: 5px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      cursor: pointer;
      transition: background-color 0.3s;
      position: relative;
    }
    .grid-cell:hover {
      background-color: #555;
    }
    .grid-cell.owned {
      background-color: #008080;
    }
    .grid-cell.enemy {
      background-color: #800000;
    }
    .cell-troops {
      position: absolute;
      bottom: 5px;
      right: 5px;
      font-size: 12px;
      background-color: rgba(0, 0, 0, 0.5);
      padding: 2px 5px;
      border-radius: 3px;
    }
    .buildings {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      margin-bottom: 20px;
    }
    .building {
      background-color: #444;
      padding: 15px;
      border-radius: 5px;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    .building:hover {
      background-color: #555;
    }
    .building h3 {
      margin-top: 0;
      color: #008080;
    }
    .building p {
      margin-bottom: 5px;
      font-size: 14px;
    }
    .building-cost {
      display: flex;
      gap: 10px;
      font-size: 12px;
      color: #aaa;
    }
    .actions {
      display: flex;
      gap: 10px;
    }
    .action-btn {
      background-color: #008080;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 5px;
      cursor: pointer;
      transition: background-color 0.3s;
      flex: 1;
    }
    .action-btn:hover {
      background-color: #006666;
    }
    .action-btn:disabled {
      background-color: #444;
      cursor: not-allowed;
    }
    .game-log {
      height: 100px;
      overflow-y: auto;
      background-color: #222;
      padding: 10px;
      border-radius: 5px;
      margin-top: 20px;
      font-size: 14px;
    }
    .log-entry {
      margin-bottom: 5px;
      padding-bottom: 5px;
      border-bottom: 1px solid #333;
    }
    .turn-indicator {
      font-size: 18px;
      font-weight: bold;
      color: #008080;
    }
  </style>
</head>
<body>
  <div class="game-container">
    <div class="game-header">
      <div class="turn-indicator">Turn: <span id="turnCounter">1</span></div>
      <div class="resources">
        <div class="resource">
          <div class="resource-icon"></div>
          <span>Gold: <span id="goldCounter">100</span></span>
        </div>
        <div class="resource">
          <div class="resource-icon" style="background-color: #DAA520;"></div>
          <span>Food: <span id="foodCounter">50</span></span>
        </div>
        <div class="resource">
          <div class="resource-icon" style="background-color: #B22222;"></div>
          <span>Troops: <span id="troopsCounter">10</span></span>
        </div>
      </div>
    </div>
    
    <div class="game-grid" id="gameGrid"></div>
    
    <div class="buildings">
      <div class="building" id="buildFarm">
        <h3>Farm</h3>
        <p>Produces 10 food per turn</p>
        <div class="building-cost">Cost: 30 Gold</div>
      </div>
      <div class="building" id="buildMine">
        <h3>Gold Mine</h3>
        <p>Produces 15 gold per turn</p>
        <div class="building-cost">Cost: 50 Gold</div>
      </div>
      <div class="building" id="buildBarracks">
        <h3>Barracks</h3>
        <p>Trains 5 troops per turn</p>
        <div class="building-cost">Cost: 40 Gold, 20 Food</div>
      </div>
    </div>
    
    <div class="actions">
      <button class="action-btn" id="endTurnBtn">End Turn</button>
      <button class="action-btn" id="attackBtn" disabled>Attack</button>
    </div>
    
    <div class="game-log" id="gameLog">
      <div class="log-entry">Welcome to Strategy Commander! Expand your territory and defeat enemies.</div>
    </div>
  </div>

  <script>
    // Game variables
    let turn = 1;
    let gold = 100;
    let food = 50;
    let troops = 10;
    let selectedCell = null;
    let attackMode = false;
    
    // Grid setup
    const gridSize = 5;
    const grid = [];
    
    // DOM elements
    const gameGrid = document.getElementById('gameGrid');
    const turnCounter = document.getElementById('turnCounter');
    const goldCounter = document.getElementById('goldCounter');
    const foodCounter = document.getElementById('foodCounter');
    const troopsCounter = document.getElementById('troopsCounter');
    const buildFarm = document.getElementById('buildFarm');
    const buildMine = document.getElementById('buildMine');
    const buildBarracks = document.getElementById('buildBarracks');
    const endTurnBtn = document.getElementById('endTurnBtn');
    const attackBtn = document.getElementById('attackBtn');
    const gameLog = document.getElementById('gameLog');
    
    // Initialize the game
    function initGame() {
      // Create grid
      for (let i = 0; i < gridSize; i++) {
        for (let j = 0; j < gridSize; j++) {
          const cell = {
            row: i,
            col: j,
            owner: 'neutral',
            building: null,
            troops: 0
          };
          
          grid.push(cell);
          
          // Player starts with one cell
          if (i === gridSize - 1 && j === Math.floor(gridSize / 2)) {
            cell.owner = 'player';
            cell.troops = 5;
          }
          
          // Enemy starts with one cell
          if (i === 0 && j === Math.floor(gridSize / 2)) {
            cell.owner = 'enemy';
            cell.troops = 5;
          }
        }
      }
      
      renderGrid();
      updateResources();
      
      // Add event listeners
      buildFarm.addEventListener('click', () => buildStructure('farm'));
      buildMine.addEventListener('click', () => buildStructure('mine'));
      buildBarracks.addEventListener('click', () => buildStructure('barracks'));
      endTurnBtn.addEventListener('click', endTurn);
      attackBtn.addEventListener('click', toggleAttackMode);
    }
    
    // Render the grid
    function renderGrid() {
      gameGrid.innerHTML = '';
      
      grid.forEach((cell, index) => {
        const cellElement = document.createElement('div');
        cellElement.className = 'grid-cell';
        
        if (cell.owner === 'player') {
          cellElement.classList.add('owned');
        } else if (cell.owner === 'enemy') {
          cellElement.classList.add('enemy');
        }
        
        if (cell.building) {
          let icon = '';
          switch (cell.building) {
            case 'farm': icon = '🌾'; break;
            case 'mine': icon = '⛏️'; break;
            case 'barracks': icon = '⚔️'; break;
          }
          cellElement.textContent = icon;
        }
        
        if (cell.troops > 0) {
          const troopsElement = document.createElement('div');
          troopsElement.className = 'cell-troops';
          troopsElement.textContent = cell.troops;
          cellElement.appendChild(troopsElement);
        }
        
        cellElement.addEventListener('click', () => handleCellClick(index));
        
        gameGrid.appendChild(cellElement);
      });
    }
    
    // Handle cell click
    function handleCellClick(index) {
      const cell = grid[index];
      
      if (attackMode) {
        if (selectedCell !== null && cell.owner !== 'player') {
          attackCell(selectedCell, index);
          attackMode = false;
          attackBtn.textContent = 'Attack';
          selectedCell = null;
        } else if (cell.owner === 'player' && cell.troops > 1) {
          selectedCell = index;
          addLogEntry(`Selected cell at (${cell.row}, ${cell.col}) with ${cell.troops} troops for attack.`);
        }
      } else {
        if (cell.owner === 'player') {
          selectedCell = index;
          attackBtn.disabled = cell.troops <= 1;
          addLogEntry(`Selected cell at (${cell.row}, ${cell.col}).`);
        } else {
          addLogEntry('You can only select your own territories.');
        }
      }
    }
    
    // Toggle attack mode
    function toggleAttackMode() {
      attackMode = !attackMode;
      attackBtn.textContent = attackMode ? 'Cancel Attack' : 'Attack';
      
      if (attackMode) {
        addLogEntry('Attack mode activated. Select an enemy or neutral territory to attack.');
      } else {
        addLogEntry('Attack mode deactivated.');
        selectedCell = null;
      }
    }
    
    // Attack a cell
    function attackCell(sourceIndex, targetIndex) {
      const sourceCell = grid[sourceIndex];
      const targetCell = grid[targetIndex];
      
      // Check if cells are adjacent
      if (!areCellsAdjacent(sourceCell, targetCell)) {
        addLogEntry('You can only attack adjacent territories.');
        return;
      }
      
      const attackingTroops = Math.floor(sourceCell.troops * 0.7);
      sourceCell.troops -= attackingTroops;
      
      // Determine battle outcome
      if (attackingTroops > targetCell.troops) {
        // Victory
        const remainingTroops = attackingTroops - targetCell.troops;
        targetCell.owner = 'player';
        targetCell.troops = remainingTroops;
        addLogEntry(`Attack successful! Captured territory at (${targetCell.row}, ${targetCell.col}) with ${remainingTroops} troops remaining.`);
      } else {
        // Defeat
        targetCell.troops -= attackingTroops;
        addLogEntry(`Attack failed! Enemy at (${targetCell.row}, ${targetCell.col}) has ${targetCell.troops} troops remaining.`);
      }
      
      renderGrid();
      updateResources();
      attackBtn.disabled = true;
    }
    
    // Check if two cells are adjacent
    function areCellsAdjacent(cell1, cell2) {
      return (
        (Math.abs(cell1.row - cell2.row) === 1 && cell1.col === cell2.col) ||
        (Math.abs(cell1.col - cell2.col) === 1 && cell1.row === cell2.row)
      );
    }
    
    // Build a structure
    function buildStructure(type) {
      if (selectedCell === null) {
        addLogEntry('Select a territory first to build a structure.');
        return;
      }
      
      const cell = grid[selectedCell];
      
      if (cell.building) {
        addLogEntry('This territory already has a building.');
        return;
      }
      
      let canBuild = false;
      
      switch (type) {
        case 'farm':
          if (gold >= 30) {
            gold -= 30;
            canBuild = true;
          } else {
            addLogEntry('Not enough gold to build a farm.');
          }
          break;
        case 'mine':
          if (gold >= 50) {
            gold -= 50;
            canBuild = true;
          } else {
            addLogEntry('Not enough gold to build a mine.');
          }
          break;
        case 'barracks':
          if (gold >= 40 && food >= 20) {
            gold -= 40;
            food -= 20;
            canBuild = true;
          } else {
            addLogEntry('Not enough resources to build barracks.');
          }
          break;
      }
      
      if (canBuild) {
        cell.building = type;
        addLogEntry(`Built a ${type} at (${cell.row}, ${cell.col}).`);
        renderGrid();
        updateResources();
      }
    }
    
    // End the current turn
    function endTurn() {
      turn++;
      turnCounter.textContent = turn;
      
      // Process player buildings
      grid.forEach(cell => {
        if (cell.owner === 'player') {
          switch (cell.building) {
            case 'farm':
              food += 10;
              break;
            case 'mine':
              gold += 15;
              break;
            case 'barracks':
              troops += 5;
              cell.troops += 2;
              break;
          }
        }
      });
      
      // Enemy AI turn
      processEnemyTurn();
      
      updateResources();
      renderGrid();
      selectedCell = null;
      attackBtn.disabled = true;
      
      addLogEntry(`Turn ${turn} ended. Resources updated.`);
      
      // Check win/lose conditions
      checkGameEnd();
    }
    
    // Process enemy turn
    function processEnemyTurn() {
      // Simple AI: expand and attack
      const enemyCells = grid.filter(cell => cell.owner === 'enemy');
      
      // Add troops to enemy territories
      enemyCells.forEach(cell => {
        cell.troops += 2;
      });
      
      // Try to expand
      if (Math.random() < 0.7) { // 70% chance to attack
        const enemyCell = enemyCells[Math.floor(Math.random() * enemyCells.length)];
        
        // Find adjacent cells
        const adjacentCells = grid.filter(cell => 
          areCellsAdjacent(enemyCell, cell) && cell.owner !== 'enemy'
        );
        
        if (adjacentCells.length > 0 && enemyCell.troops > 3) {
          const targetCell = adjacentCells[Math.floor(Math.random() * adjacentCells.length)];
          const attackingTroops = Math.floor(enemyCell.troops * 0.7);
          enemyCell.troops -= attackingTroops;
          
          if (attackingTroops > targetCell.troops) {
            // Enemy victory
            const remainingTroops = attackingTroops - targetCell.troops;
            const oldOwner = targetCell.owner;
            targetCell.owner = 'enemy';
            targetCell.troops = remainingTroops;
            targetCell.building = null; // Destroy building
            
            if (oldOwner === 'player') {
              addLogEntry(`Enemy captured your territory at (${targetCell.row}, ${targetCell.col})!`);
            } else {
              addLogEntry(`Enemy expanded to neutral territory at (${targetCell.row}, ${targetCell.col}).`);
            }
          } else {
            // Enemy defeat
            targetCell.troops -= attackingTroops;
            addLogEntry(`Enemy attack on (${targetCell.row}, ${targetCell.col}) was repelled!`);
          }
        }
      }
      
      // Randomly build on enemy territories
      if (Math.random() < 0.3) { // 30% chance to build
        const buildableCell = enemyCells.find(cell => !cell.building);
        if (buildableCell) {
          const buildingTypes = ['farm', 'mine', 'barracks'];
          buildableCell.building = buildingTypes[Math.floor(Math.random() * buildingTypes.length)];
          addLogEntry(`Enemy built a ${buildableCell.building} at (${buildableCell.row}, ${buildableCell.col}).`);
        }
      }
    }
    
    // Check if the game has ended
    function checkGameEnd() {
      const playerCells = grid.filter(cell => cell.owner === 'player');
      const enemyCells = grid.filter(cell => cell.owner === 'enemy');
      
      if (playerCells.length === 0) {
        addLogEntry('GAME OVER: You have been defeated!');
        endTurnBtn.disabled = true;
        attackBtn.disabled = true;
      } else if (enemyCells.length === 0) {
        addLogEntry('VICTORY: You have conquered all enemy territories!');
        endTurnBtn.disabled = true;
        attackBtn.disabled = true;
      }
    }
    
    // Update resource displays
    function updateResources() {
      goldCounter.textContent = gold;
      foodCounter.textContent = food;
      
      // Calculate total troops
      const totalTroops = grid.reduce((sum, cell) => {
        return sum + (cell.owner === 'player' ? cell.troops : 0);
      }, 0);
      
      troops = totalTroops;
      troopsCounter.textContent = troops;
    }
    
    // Add entry to game log
    function addLogEntry(message) {
      const entry = document.createElement('div');
      entry.className = 'log-entry';
      entry.textContent = message;
      gameLog.appendChild(entry);
      gameLog.scrollTop = gameLog.scrollHeight;
    }
    
    // Initialize the game
    initGame();
  </script>
</body>
</html>
